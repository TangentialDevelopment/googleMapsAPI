<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Geocoding App</title>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
  </head>
  <body>
    <div class="container">
      <h2 id="text-center">Enter location: </h2>
      <form id="location-form" action="index.html" method="post">
        <input type="text" class="form-control form-contol-lg" id="location-input">
        <br>
        <button type="submit" class="btn btn-primary btn-block">Submit</button>
      </form>

      <div class="card-block" id="formatted-address"></div>
      <div class="card-block" id="address-components"></div>
      <div class="card-block" id="geometry"></div>
    </div>

    <script type="text/javascript">
      var locationForm = document.getElementById('location-form');
      locationForm.addEventListener('submit', geocode);

      function geocode(e) {
        //prevent actual submit
        e.preventDefault();

        var location = document.getElementById('location-input').value;
        axios.get('https://maps.googleapis.com/maps/api/geocode/json', {
          params: {
            address: location,
            key: 'AIzaSyCCULqWKsXeffny_1k4S1OgSriSkZeQH8I'
          }
        })
        .then(function(response) {
          console.log(response);

          var formattedAddress = response.data.results[0].formatted_address;
          var formattedAddressOut = `
              <ul class="list-group">
                <li class="list-group-item">${formattedAddress}</li>
              </ul>
            `;

          var addressComponents = response.data.results[0].address_components;
          var addressComponentsOut = '<ul class="list-group">';
          for (var i=0; i<addressComponents.length; i++) {
            addressComponentsOut += `
              <li class="list-group-item"><strong>${addressComponents[i].types[0]}</strong>: ${addressComponents[i].long_name}</li>
            `;
          }
          addressComponentsOut += '</ul>';

          var lat = response.data.results[0].geometry.location.lat;
          var lng = response.data.results[0].geometry.location.lng;
          var geometryOut = `
              <ul class="list-group">
                <li class="list-group-item"><strong>lat</strong>: ${lat}</li>
                <li class="list-group-item"><strong>lng</strong>: ${lng}</li>
              </ul>
            `;

          document.getElementById('formatted-address').innerHTML = formattedAddressOut;
          document.getElementById('address-components').innerHTML = addressComponentsOut;
          document.getElementById('geometry').innerHTML = geometryOut;
        })
        .catch(function(error) {
          console.log(error);
        })
      }
    </script>
  </body>
</html>
